#  Test that we can pass a mix of struct and non-struct arguments according to
#  * the ABI 









use "string"

#  This type comes from Listing 18-45
type struc two_longs(    a: i64    , b: i64    )

type struc one_int(
    i: i32    , c: char    )

type struc one_int_exactly(
    l: u64    )

type struc two_ints(
    c: char    , arr: [3]i32    )

type struc two_ints_nested(    a: struc one_int    
    , b: struc one_int    )

type struc twelve_bytes(    i: i32    , arr: [8]char    )

type struc one_xmm(    d: f64    )

type struc two_xmm(    d: [2]f64    )

type struc int_and_xmm(    c: char    , d: f64    
    )

type struc xmm_and_int(    dbl: struc one_xmm    
    , c: [3]char    )

type struc odd_size(
    arr: [5]char    )

type struc memory(
    d: f64    , c: [3]char    , l: i64    , i: i32    )

#  passing structures as parameters

#  all arguments fit in registers
pub fn pass_small_structs(two_xmm_struct: struc two_xmm, int_struct: struc one_int, xmm_struct: struc one_xmm, mixed_struct: struc xmm_and_int, int_struct_2: struc twelve_bytes, another_int_struct: struc one_int_exactly) i32;





#  based on example in Listing 18-45
pub fn a_bunch_of_arguments(i0: i32, i1: i32, i2: i32, i3: i32, i4: i32, param: struc two_longs, i5: i32) i32;


#  use remaining structure types, mix with scalars
pub fn structs_and_scalars(l: i64, d: f64, os: struc odd_size, mem: struc memory, xmm_struct: struc one_xmm) i32;


#  pass fourth_struct in memory b/c we're out of XMM registers
pub fn struct_in_mem(a: f64, b: f64, c: f64, first_struct: struc xmm_and_int, d: f64, second_struct: struc two_xmm, l: i64, third_struct: struc int_and_xmm, fourth_struct: struc one_xmm) i32;




#  pass two_ints_nested in memory - we have one general-purpose reg left for
#  parameter passing but it requires two
pub fn pass_borderline_struct_in_memory(t_i
    : struc two_ints, c: i32, i_x: struc int_and_xmm, ptr: *
    any, t_i_n: struc two_ints_nested, d: f64) i32;



#  pass a struct in memory that isn't neatly divisible by 8
pub fn pass_uneven_struct_in_mem(struct1: struc twelve_bytes, 
    a: i64, b: 
    i64, struct2: struc twelve_bytes, os: struc odd_size, m: struc memory) bool;



#  pass first struct in memory, later structs in registers
pub fn pass_later_structs_in_regs(m: struc memory, struct1: struc twelve_bytes, struct2: struc one_xmm) i32;
